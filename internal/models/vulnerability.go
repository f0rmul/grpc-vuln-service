package models

import (
	"strconv"

	"github.com/f0rmul/vuln-service/pkg/netvuln_v1"
)

type Vulnerability struct {
	ID   string
	CVSS string
}

func (v *Vulnerability) ToProto() *netvuln_v1.Vulnerability {
	cvss, _ := strconv.ParseFloat(v.CVSS, 32) //DON'T SKIP ERRORS

	return &netvuln_v1.Vulnerability{
		Identifier: v.ID,
		CvssScore:  float32(cvss),
	}
}
